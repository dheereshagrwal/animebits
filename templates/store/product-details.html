{% extends 'base.html' %}
<!-- static -->
{% load static %}
<!-- block content  -->
{% block content %}
<link href="{% static 'css/rating.css' %}" rel="stylesheet" type="text/css" />
<section class="container-fluid mt-5">
  <div class="row">
    <div class="col-lg-4">
      <div id="product_gallery" class="carousel slide">
        <div class="carousel-indicators">
          <button
            type="button"
            data-bs-target="#product_gallery"
            data-bs-slide-to="0"
            class="active"
            aria-current="true"
            aria-label="Slide 1"
          ></button>
          {% for image in product_gallery %}
          <button
            type="button"
            data-bs-target="#product_gallery"
            data-bs-slide-to="{{ forloop.counter }}"
            aria-label="Slide {{ forloop.counter|add:1 }}"
          ></button>
          {% endfor %}
        </div>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img
              src="{{product.image.url}}"
              class="d-block w-100"
              alt="product image"
            />
          </div>
          {% for image in product_gallery %}
          <div class="carousel-item">
            <img
              src="{{image.image.url}}"
              class="d-block w-100"
              alt="product image"
            />
          </div>
          {% endfor %}
        </div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#product_gallery"
          data-bs-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#product_gallery"
          data-bs-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </div>
    <main class="col-lg-7 d-flex flex-column justify-content-between mx-auto">
      <div>
        <h2 class="font-poppins text-white fs-1 text-capitalize">
          {{product.name}}
        </h2>
        <div class="mb-4">
          {% if product.average_rating > 0 and product.average_rating <= 0.5 %}
          <i class="bi bi-star-half text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 0.5 and product.average_rating <= 1 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 1 and product.average_rating <= 1.5 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-half text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 1.5 and product.average_rating <= 2 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 2 and product.average_rating <= 2.5 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-half text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 2.5 and product.average_rating <= 3 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 3 and product.average_rating <= 3.5 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-half text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 3.5 and product.average_rating <= 4 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 4 and product.average_rating <= 4.5 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-half text-warning"></i>
          {% endif %}
          <!-- separator -->
          {% if product.average_rating > 4.5 and product.average_rating <= 5 %}
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          <i class="bi bi-star-fill text-warning"></i>
          {% endif %}
          <span class="text-secondary font-rubik"
            >{{reviews.count}} reviews</span
          >
        </div>
        <var class="text-secondary fw-bold fs-3 font-rubik"
          >&#8377;{{product.price}}</var
        >
        <p class="text-white font-dm-sans fs-5">{{product.description}}</p>
      </div>

      <form
        class="font-karla"
        action="{% url 'add_cart' product.id %}"
        method="POST"
      >
        {% csrf_token %}
        <div>
          <h6 class="text-white">Select Size</h6>
          <div
            class="btn-group btn-group-lg"
            role="group"
            aria-label="Size options"
          >
            {% for i in product.variation_set.sizes %}
            <input
              type="radio"
              class="btn-check"
              name="size"
              id="{{ i.variation_value }}"
              value="{{ i.variation_value }}"
              required
            />
            <label class="btn btn-outline-primary" for="{{ i.variation_value }}"
              >{{ i.variation_value }}</label
            >
            {% endfor %}
          </div>
        </div>
        <br />
        <div
          class="form-check animate__animated animate__headShake animate__delay-2s"
        >
          <input
            class="form-check-input"
            type="checkbox"
            value="gift"
            id="gift"
            name="gift"
          />
          <label class="form-check-label fw-semibold text-white font-karla" for="gift">
            üéÅWant to wrap as a gift?
          </label>
        </div>
        <br />
        <div>
          <div class="btn-group" role="group">
            {% if product.stock > 0 and product.is_available %}
            <button class="btn btn-primary font-inter me-1" type="submit">
              <span>Add to cart</span>
              <i class="bi bi-cart-plus"></i>
            </button>
            <a href="{% url 'cart' %}" class="btn btn-secondary font-inter">
              <span>View Cart</span>
              <i class="bi bi-cart-fill"></i>
            </a>
            {% else %}
            <button class="btn btn-danger disabled font-inter">
              <span>Out of stock</span>
              <i class="bi bi-cart-x"></i>
            </button>
            <a href="{% url 'cart' %}" class="btn btn-primary font-inter">
              <span>View Cart</span>
              <i class="bi bi-cart-fill"></i>
            </a>
            {% endif %}
          </div>
        </div>
      </form>
    </main>
  </div>
  <div class="mx-3 mx-lg-5 mt-5">
    <h5 class="font-karla fw-bold mt-5 text-white">Write Your Review</h5>
    <form method="POST" action="{% url 'submit_review' product.id %}">
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label text-white font-karla" for="rating"
          >How do you rate this product?</label
        >
        <br />
        <div class="rating" id="rating">
          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star10"
            value="5"
          />
          <label class="form-check-label" for="star10" title="5"></label>
          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star9"
            value="4.5"
          />
          <label class="form-check-label half" for="star9" title="4.5"></label>
          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star8"
            value="4"
          />
          <label class="form-check-label" for="star8" title="4"></label>

          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star7"
            value="3.5"
          />
          <label class="form-check-label half" for="star7" title="3.5"></label>

          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star6"
            value="3"
          />
          <label class="form-check-label" for="star6" title="3"></label>

          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star5"
            value="2.5"
          />
          <label class="form-check-label half" for="star5" title="2.5"></label>
          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star4"
            value="2"
          />
          <label class="form-check-label" for="star4" title="2"></label>

          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star3"
            value="1.5"
          />
          <label class="form-check-label half" for="star3" title="1.5"></label>

          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star2"
            value="1"
          />
          <label class="form-check-label" for="star2" title="1"></label>

          <input
            class="form-check-input d-none"
            type="radio"
            name="rating"
            id="star1"
            value="0.5"
          />
          <label class="form-check-label half" for="star1" title="0.5"></label>
        </div>
      </div>
      <div class="mb-3">
        <label for="title" class="form-label text-white font-karla"
          >Review Title</label
        >
        <input
          type="text"
          class="form-control bg-dark text-white border border-secondary font-karla"
          id="title"
          name="title"
          placeholder="Awesome T-shirt"
        />
      </div>
      <div class="mb-3">
        <label for="review" class="form-label text-white font-karla"
          >Write a review</label
        >
        <textarea
          class="form-control bg-dark text-white border border-secondary"
          id="review"
          rows="3"
          name="review"
        ></textarea>
      </div>
      {% if user.is_authenticated %}
      <!-- separator -->
      {% if order_product %}
      <input
        type="submit"
        class="btn btn-primary font-inter"
        value="Submit Review"
      />
      {% else %}
      <p class="text-white font-karla">
        You must purchase this product to add a review.
      </p>
      {% endif %}
      <!-- separator -->
      {% else %}
      <p class="text-white font-dm-sans">
        You must be logged in to post a review.
        <a href="{% url 'login' %}" class="text-decoration-none">Login now</a>
      </p>
      {% endif %}
    </form>
    <h3 class="font-poppins fw-bold mt-5 text-white">Customer Reviews</h3>
    <div class="mb-4">
      {% if product.average_rating > 0 and product.average_rating <= 0.5 %}
      <i class="bi bi-star-half text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 0.5 and product.average_rating <= 1 %}
      <i class="bi bi-star-fill text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 1 and product.average_rating <= 1.5 %}
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-half text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 1.5 and product.average_rating <= 2 %}
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 2 and product.average_rating <= 2.5 %}
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-half text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 2.5 and product.average_rating <= 3 %}
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 3 and product.average_rating <= 3.5 %}
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-half text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 3.5 and product.average_rating <= 4 %}
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 4 and product.average_rating <= 4.5 %}
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-half text-warning"></i>
      {% endif %}
      <!-- separator -->
      {% if product.average_rating > 4.5 and product.average_rating <= 5 %}
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      <i class="bi bi-star-fill text-warning"></i>
      {% endif %}
      <span class="text-white font-rubik">{{reviews.count}} reviews</span>
    </div>
    {% for review in reviews %}
    <div class="px-3 pt-3 bg-light">
      <div class="d-flex">
        <div class="d-flex gap-2">
          <img
            src="{{user_info.picture}}"
            class="rounded-circle"
            width="30"
            height="30"
          />
          <h6 class="mt-auto">{{review.user}}</h6>
        </div>
        <date class="ms-auto">{{review.updated_at}}</date>
      </div>
      <div class="mb-3">
        {% if review.rating == 5 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        {% elif review.rating == 4.5 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-half text-warning"></i>
        {% elif review.rating == 4 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star"></i>
        {% elif review.rating == 3.5 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-half text-warning"></i>
        <i class="bi bi-star"></i>
        {% elif review.rating == 3 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        {% elif review.rating == 2.5 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-half text-warning"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        {% elif review.rating == 2 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        {% elif review.rating == 1.5 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star-half text-warning"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        {% elif review.rating == 1 %}
        <i class="bi bi-star-fill text-warning"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        {% elif review.rating == 0.5 %}
        <i class="bi bi-star-half text-warning"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        <i class="bi bi-star"></i>
        {% endif %}
      </div>
      <h6>{{review.title}}</h6>
      <p>{{review.review}}</p>
    </div>
    {% endfor %}
  </div>
</section>

{% endblock %}
